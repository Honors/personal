<!DOCTYPE>
<html>
	<head>
		<title>Matt Neary</title>
		<meta name="viewport" content="initial-scale = 1.0,maximum-scale = 1.0" />
		
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
		
		<link rel="stylesheet" href="styles/github.css">
		<link rel="stylesheet" href="styles/funky-prism.css">		
		<link rel="stylesheet" href="styles/style.css">
		<link href='http://fonts.googleapis.com/css?family=Great+Vibes' rel='stylesheet' type='text/css'>
		
		<script src="scripts/knockout-2.2.1.js"></script>
		<script src="scripts/ko-model.js"></script>
		<script src="scripts/showdown.js"></script>
		<script src="scripts/prism.js"></script>
	</head>
	<body>				
		<div id="header">
			<h1>Matthew Neary</h1>
		</div>
		
		<select data-bind="options: Posts.all(), optionsText: function(item) {return item.title}, event: { click: Posts.click.bind(Posts) }"></select>
		<ul id="posts" data-bind="foreach: Posts.all()">
			<li><a data-bind="text: title, event: { click: Posts.click.bind(Posts) }"></a></li>
		</ul>
		
		<div id="content" data-bind="html: Posts.current()"></div>				
		<script>
			// syntax highlighting for obscure languages
			Prism.languages.lambda = {
				'operator': /-&gt;|=/g,
				'punctuation': /[\)\(]/g,
				'keyword': /\u03BB/g
			};			
			Prism.languages.types = {
				'operator': /::=|\||:|-&gt;/g,
				'punctuation': /[,.]/g,
				'keyword': /&lt;[^&]+&gt;/g
			};						
			
			var converter = new Showdown.converter();
			var Posts = new Model('post', {
				content: converter.makeHtml.bind(converter),
				link: function(link) {
					// provide default value for article link
					return this.link() || (location.hash ? location.hash.substr(3) : (this.all().length ? this.all()[0].link : 'from_within.md'));
				},
				click: function(item, evt) {				
					// change article upon link click	
					return evt.target.selectedIndex ? (this.all().length ? this.all()[evt.target.selectedIndex].link : '') : item.link;
				},
				hash: function() {
					// listen for link changes and reflect in hash
					setTimeout(Prism.highlightAll.bind(Prism), 200);
					if( this.link() ) {
						location.hash = '#!/'+this.link();
					}
				}
			});
			ko.applyBindings(Posts);
		</script>
	</body>
</html>